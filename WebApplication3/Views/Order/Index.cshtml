@model WebApplication3.ViewModel.CategoryAndProduct
@using Newtonsoft.Json

@{
    ViewBag.Title = "Index";
}

<h2>POS</h2>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/OrederIndexPage.css" rel="stylesheet" />

<style>
    .invoice {
        height: 700px;
        width: 300px;
        border-style: solid;
        border-width: medium;
    }
    .sub {
        height: auto;
        width: auto;
        //border-style: solid;
        //border-width: medium;
        border-bottom: 1px solid;
    }

    .sidenav {
                height: 100%; /* Full-height: remove this if you want "auto" height */
                width: 40%; /* Set the width of the sidebar */
                position: fixed; /* Fixed Sidebar (stay in place on scroll) */
                z-index: 1; /* Stay on top */
                top: 5%; /* Stay at the top */
                left: 0%;
                background-color: #f1f1f1; /* Black */
                overflow-x: hidden; /* Disable horizontal scroll */
                padding-top: 0px;
                border-right: 2px solid;
            }

        /* The navigation menu links */
    .sidenav a {
                padding: 6px 8px 6px 16px;
                text-decoration: none;
                font-size: 25px;
                color: #818181;
                display: block;
               }
    .content {
        height: 100%;
        width: 60%;
        position: fixed;
        z-index: 1; /* Stay on top */
        top: 5%; /* Stay at the top */
        left: 40%;
        bottom: 0;
        background-color: #f1f1f1; /* Black */
        overflow-x: hidden; /* Disable horizontal scroll */
        padding-top: 20px;
    }

        .content button {
            padding: 6px 8px 6px 16px;
            left: 1%;
            text-decoration: none;          
            display: block;
        }
    .sidenav h1 {
        padding-top: 0;
        font-size: 31px;
        color: white;
        height: auto;
        width: 100%;
        background-color: Highlight;
    }

</style>


    <div class="panel panel-body bod">
        <div class="col-lg-4">
            <div class="sidenav">
                <h1>Invoice</h1>

                <div id="invoice">

                </div>
                
            </div>
        </div>
        <div class="col-lg-8">
            <div class="content">
                @using (Html.BeginForm())
            {
                    @Html.AntiForgeryToken()
                    <div class="row">
                        <div class="btn-group">
                            @foreach (var item in Model.categories)
                            {


                                <button type="button" data-id="@item.Id" class="btn btn-primary category">@item.Name</button>




                            }
                        </div>


                    </div>


                }

                <div class="col-lg-8">
                    <div id="link">

                    </div>
                </div>

            </div>

        </div>

           <b id="ah">ahmed</b>

    </div>

<script language="javascript" type="text/javascript">

    $(document).ready(function () {
        $('.category').click(function () {
            var id = $(this).data('id');

            $.ajax({
                url: "/Order/GetSubCategory",
                data: { data: id },
                success: function (mydata) {
                    //alert("success");
                    $('#link').html(mydata);
                },
                error: function (mydata) { alert("error"); alert(mydata); },
                type: 'GET'
            });
            return false;
        });
    });
    var items = [];
    function myFunction(e) {
        //e.preventDefault();
        
        var id = e;
        //var p = " ";
        //var data = @@Html.Raw(JsonConvert.SerializeObject(this.Model.products));
        //var x = document.querySelector('productname').id;
        //var pname = $('#ah').val().trim();
        //alert(x);
        //var price = data.price.
        data = { id: id };


        $.get('/Order/GetData', // url
            data, // parameters for action
            function (response) { // success callback
                // response has the same properties as the server returnedObject
                //alert(JSON.stringify(response));
                //alert(JSON.stringify(response.Price));
                //alert(p);
                //var obj = JSON.parse(response);
                //alert(obj);
                n = response[0].Name;
                p = response[0].Price;
                items.push({
                    ProductId: id,
                    ProductName: n,
                    UnitPrice: p
                    //UnitQuantity: $('#UnitQuantity').val().trim()

                });
                GeneratedInvoice(items);
                //console.log(items.length);

            },
            'json' // dataType
            
        );
        //console.log(items.length);
        
        //console.log(items);
        //alert(n);
        //alert(p);
        //GeneratedInvoice(items);

    }
    
    function GeneratedInvoice(items) {

        console.log(Object.keys(items).length);
        var $table = $('<table/>');
        $table.append('<thead><tr><th>PrductId</th>  <th>ProductName</th>  <th>Price</th></tr></thead>');
        var $tbody = $('<tbody/>');
        //alert("i am out");
        //if (items.length > 0) {
        //   console.log(items);
        // }
        $.each(items, function (i, val) {

            var $row = $('<tr/>');
            $row.append($('<td/>').html(val.ProductId));

            $row.append($('<td/>').html(val.ProductName));
            $row.append($('<td/>').html(val.UnitPrice));
            $tbody.append($row);
        });
        console.log("current", items);
        $table.append($tbody);
        $('#invoice').html($table);
    }
</script>
